<!-- Declarative SPA: Contact Form with Validation -->
<!-- Demonstrates form validation, conditional rendering, and multi-step flow -->

<article class="contact-form-demo">
  <script type="context" context="form-state">
    {
      "step": 1,
      "formData": {
        "name": "",
        "email": "",
        "company": "",
        "message": "",
        "interests": []
      },
      "errors": {},
      "submitted": false
    }
  </script>

  <header>
    <h1>Contact Us</h1>
    <div class="progress-bar">
      <div 
        class="progress-fill" 
        bind-style:width="(form-state/step / 3 * 100) + '%'"
      ></div>
    </div>
  </header>

  <!-- Step 1: Personal Information -->
  <section 
    class="form-step"
    bind-hidden="form-state/step != 1"
  >
    <h2>Personal Information</h2>
    
    <div class="form-field">
      <label for="name">Name *</label>
      <input 
        id="name"
        type="text" 
        bind-value="form-state/formData.name"
        on:blur="form-state/validateName"
        aria-required="true"
      />
      <span 
        class="error-message"
        bind-text="form-state/errors.name"
        bind-hidden="!form-state/errors.name"
        role="alert"
      ></span>
    </div>

    <div class="form-field">
      <label for="email">Email *</label>
      <input 
        id="email"
        type="email" 
        bind-value="form-state/formData.email"
        on:blur="form-state/validateEmail"
        aria-required="true"
      />
      <span 
        class="error-message"
        bind-text="form-state/errors.email"
        bind-hidden="!form-state/errors.email"
        role="alert"
      ></span>
    </div>

    <div class="form-field">
      <label for="company">Company</label>
      <input 
        id="company"
        type="text" 
        bind-value="form-state/formData.company"
      />
    </div>

    <button 
      type="button"
      on:click="form-state/nextStep"
      class="btn-primary"
    >
      Next Step
    </button>
  </section>

  <!-- Step 2: Interests -->
  <section 
    class="form-step"
    bind-hidden="form-state/step != 2"
  >
    <h2>Your Interests</h2>
    <p>Select all that apply:</p>

    <div class="checkbox-group">
      <label class="checkbox-label">
        <input 
          type="checkbox"
          bind-checked="form-state/formData.interests"
          value="webinjectors"
        />
        Web Injectors
      </label>
      <label class="checkbox-label">
        <input 
          type="checkbox"
          bind-checked="form-state/formData.interests"
          value="webcontexts"
        />
        Web Contexts
      </label>
      <label class="checkbox-label">
        <input 
          type="checkbox"
          bind-checked="form-state/formData.interests"
          value="webstates"
        />
        Web States
      </label>
      <label class="checkbox-label">
        <input 
          type="checkbox"
          bind-checked="form-state/formData.interests"
          value="webintents"
        />
        Web Intents
      </label>
    </div>

    <div class="form-actions">
      <button 
        type="button"
        on:click="form-state/prevStep"
        class="btn-secondary"
      >
        Back
      </button>
      <button 
        type="button"
        on:click="form-state/nextStep"
        class="btn-primary"
      >
        Next Step
      </button>
    </div>
  </section>

  <!-- Step 3: Message -->
  <section 
    class="form-step"
    bind-hidden="form-state/step != 3"
  >
    <h2>Your Message</h2>
    
    <div class="form-field">
      <label for="message">Message *</label>
      <textarea 
        id="message"
        bind-value="form-state/formData.message"
        on:blur="form-state/validateMessage"
        rows="6"
        aria-required="true"
      ></textarea>
      <span 
        class="error-message"
        bind-text="form-state/errors.message"
        bind-hidden="!form-state/errors.message"
        role="alert"
      ></span>
    </div>

    <div class="form-actions">
      <button 
        type="button"
        on:click="form-state/prevStep"
        class="btn-secondary"
      >
        Back
      </button>
      <button 
        type="button"
        on:click="form-state/submitForm"
        class="btn-primary"
      >
        Submit
      </button>
    </div>
  </section>

  <!-- Success Message -->
  <section 
    class="success-message"
    bind-hidden="!form-state/submitted"
  >
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
      <polyline points="22 4 12 14.01 9 11.01"/>
    </svg>
    <h2>Thank You!</h2>
    <p>We've received your message and will get back to you soon.</p>
    <button 
      type="button"
      on:click="form-state/reset"
      class="btn-primary"
    >
      Submit Another
    </button>
  </section>
</article>

<style>
  .contact-form-demo {
    max-width: 600px;
    margin: 2rem auto;
    padding: 2rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  header h1 {
    margin: 0 0 1rem;
    text-align: center;
  }

  .progress-bar {
    height: 4px;
    background: #e0e0e0;
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 2rem;
  }

  .progress-fill {
    height: 100%;
    background: #667eea;
    transition: width 0.3s ease;
  }

  .form-step {
    animation: fadeIn 0.3s ease;
  }

  .form-step[bind-hidden] {
    display: none;
  }

  .form-step h2 {
    margin: 0 0 1.5rem;
  }

  .form-field {
    margin-bottom: 1.5rem;
  }

  .form-field label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #333;
  }

  .form-field input,
  .form-field textarea {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #e0e0e0;
    border-radius: 4px;
    font-size: 1rem;
    font-family: inherit;
  }

  .form-field input:focus,
  .form-field textarea:focus {
    outline: none;
    border-color: #667eea;
  }

  .error-message {
    display: block;
    margin-top: 0.5rem;
    color: #f56565;
    font-size: 0.875rem;
  }

  .error-message[bind-hidden] {
    display: none;
  }

  .checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
  }

  .checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
  }

  .form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
  }

  .btn-primary,
  .btn-secondary {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 4px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-primary {
    background: #667eea;
    color: white;
  }

  .btn-primary:hover {
    background: #5568d3;
  }

  .btn-secondary {
    background: #e0e0e0;
    color: #333;
  }

  .btn-secondary:hover {
    background: #d0d0d0;
  }

  .success-message {
    text-align: center;
    padding: 3rem 2rem;
  }

  .success-message[bind-hidden] {
    display: none;
  }

  .success-message svg {
    color: #48bb78;
    margin-bottom: 1rem;
  }

  .success-message h2 {
    margin: 0 0 1rem;
    color: #48bb78;
  }

  .success-message p {
    margin: 0 0 2rem;
    color: #666;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
