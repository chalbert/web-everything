{% from "project-status.njk" import projectStatus %}

<section id="overview" class="section-card">
    <h3 id="overview">Overview</h3>
    <p>
        <strong>Web Plugs</strong> is the foundational layer of the Web Everything platform.
        It provides the necessary polyfills and patches to the native browser environment to enable the advanced features required by downstream projects.
    </p>
    <p>
        Each "Plug" is a modular slice of functionality. Plugs are organized by the projects they supportâ€”many plugs are shared across multiple projects, demonstrating the composable architecture of the platform.
    </p>

    <div class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-100">
        <h4 id="plug-types" class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-3">Plug Types</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
            <div class="flex items-center">
                <span class="px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 mr-2 border border-blue-200">Global</span>
                <span class="text-gray-600 text-xs">New objects on window</span>
            </div>
            <div class="flex items-center">
                <span class="px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800 mr-2 border border-amber-200">Patch</span>
                <span class="text-gray-600 text-xs">Modifies native API</span>
            </div>
        </div>
    </div>
</section>

{% macro renderProjectPlugs(projectId, projectName) %}
    {% set projectPlugs = plugs | filterByProject(projectId) %}
    {% if projectPlugs.length > 0 %}
    <section class="section-card">
        <h3 id="{{ projectId }}">
            <a href="/projects/{{ projectId }}/">{{ projectName }}</a>
        </h3>
        <div class="standards-grid">
            {% for plug in projectPlugs %}
                <a href="/plugs/{{ plug.id }}/" class="standard-card">
                    <div class="flex justify-between items-start mb-3" style="gap: 12px; display: flex; justify-content: space-between;">
                        <h4 id="plug-{{ plug.id }}" class="text-lg font-bold m-0 text-gray-900">{{ plug.name }}</h4>
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {% if plug.type == 'Global' %}bg-blue-100 text-blue-800 border border-blue-200{% else %}bg-amber-100 text-amber-800 border border-amber-200{% endif %}" style="white-space: nowrap;">
                            {{ plug.type }}
                        </span>
                    </div>
                    <p class="text-gray-600 text-sm leading-relaxed mb-4">{{ plug.summary }}</p>
                    {% if plug.projects.length > 1 %}
                    <div class="mb-3">
                        <div class="text-xs text-gray-500 mb-1">Also used by:</div>
                        <div class="flex flex-wrap gap-1">
                            {% for project in plug.projects %}
                                {% if project != projectId %}
                                <span class="px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-600">{{ project | replace("web", "") }}</span>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <div style="margin-bottom: 1rem;">
                        {{ projectStatus(plug.status) }}
                    </div>
                </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}
{% endmacro %}

{{ renderProjectPlugs("webregistries", "Web Registries") }}
{{ renderProjectPlugs("webinjectors", "Web Injectors") }}
{{ renderProjectPlugs("webcontexts", "Web Contexts") }}
{{ renderProjectPlugs("webcomponents", "Web Components") }}
{{ renderProjectPlugs("webbehaviors", "Web Behaviors") }}
{{ renderProjectPlugs("webdirectives", "Web Directives") }}
{{ renderProjectPlugs("webtokens", "Web Tokens") }}
{{ renderProjectPlugs("webstates", "Web States") }}
