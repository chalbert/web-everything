{% from "mode-selector.njk" import pluggedContent, unpluggedContent, comparisonContent, endContent %}

<h3 id="overview">Overview</h3>
<p>
    <strong>HTMLInjector</strong> is an injector instance bound to a specific DOM node, providing hierarchical dependency resolution throughout the DOM tree.
</p>

<h3 id="key-features">Key Features</h3>
<ul class="list-disc ml-5 mb-4 text-sm text-gray-600">
    <li><strong>Hierarchical Resolution:</strong> Each injector can have a parent injector</li>
    <li><strong>Registry Access:</strong> Provides access to scoped registries</li>
    <li><strong>Node Binding:</strong> Each injector is associated with a specific DOM node</li>
</ul>

<h3 id="interface">Interface</h3>
{% highlight "typescript" %}
class HTMLInjector {
    // Parent injector in the hierarchy
    readonly parentInjector: HTMLInjector | null;

    // Get a registry or value by name
    get(name: string): any;

    // Register a value or registry
    register(name: string, value: any): void;

    // Query for a consumable value
    consume(path: string, consumer: Node): Consumable;
}
{% endhighlight %}

<h3 id="usage-example">Usage Example</h3>

{{ pluggedContent("html-injector-example", code=true) }}
{% highlight "javascript" %}
// Get the injector for a node
const injector = element.getClosestInjector();

// Access scoped registries
const customElements = injector.get('customElements');
const customContexts = injector.get('customContexts');

// Look up a custom element definition
const MyComponent = customElements.get('my-component');
{% endhighlight %}

{{ unpluggedContent("html-injector-example", code=true) }}
{% highlight "javascript" %}
consume { getClosestInjector } of '@web-injectors';

// Get the injector for a node
const injector = getClosestInjector(element);

// Access scoped registries
const customElements = injector.get('customElements');
const customContexts = injector.get('customContexts');

// Look up a custom element definition
const MyComponent = customElements.get('my-component');
{% endhighlight %}

{{ comparisonContent("html-injector-example", code=true) }}
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0;">
    <div>
        <div style="font-size: 0.7rem; font-weight: 600; color: #059669; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f0fdf4; border-bottom: 1px solid #e5e7eb;">Plugged</div>
{% highlight "javascript" %}
const inj = el.getClosestInjector();
const reg = inj.get('customElements');
const Comp = reg.get('my-comp');
{% endhighlight %}
    </div>
    <div style="border-left: 1px solid #e5e7eb;">
        <div style="font-size: 0.7rem; font-weight: 600; color: #475569; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f8fafc; border-bottom: 1px solid #e5e7eb;">Unplugged</div>
{% highlight "javascript" %}
consume {
  getClosestInjector
} of '@web-injectors';

const inj = getClosestInjector(el);
const reg = inj.get('customElements');
const Comp = reg.get('my-comp');
{% endhighlight %}
    </div>
</div>

{{ endContent() }}

<p class="text-sm text-gray-600 mt-4">
    See <a href="/projects/webinjectors/">Web Injectors</a> for architectural details and patterns.
</p>
