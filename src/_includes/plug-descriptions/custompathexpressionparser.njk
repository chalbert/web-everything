{% from "mode-selector.njk" import pluggedContent, unpluggedContent, comparisonContent, endContent %}

<h3 id="overview">Overview</h3>
<p>Standardizes how strings are parsed into executable paths for use in data bindings and expressions.</p>

<h3 id="interface">Interface</h3>
{% highlight "typescript" %}
abstract class CustomPathExpressionParser {
    abstract parse(text: string): Graph;
}
{% endhighlight %}

<h3 id="use-cases">Use Cases</h3>
<ul class="list-disc ml-5 mb-4 text-sm text-gray-600">
    <li>Keypath expressions: <code>user.profile.name</code></li>
    <li>Computed properties: <code>items.length</code></li>
    <li>Method calls: <code>formatDate(date, 'YYYY-MM-DD')</code></li>
</ul>

<h3 id="usage-example">Usage Example</h3>

{{ pluggedContent("path-parser-example", code=true) }}
{% highlight "javascript" %}
// Define a custom path parser
class KeypathParser extends CustomPathExpressionParser {
    parse(text) {
        const parts = text.split('.');
        return { type: 'keypath', parts };
    }
}

// Register globally
customPathExpressionParsers.define('keypath', new KeypathParser());
{% endhighlight %}

{{ unpluggedContent("path-parser-example", code=true) }}
{% highlight "javascript" %}
consume {
  CustomPathExpressionParser,
  customPathExpressionParsers
} of '@web-expressions';

// Define a custom path parser
class KeypathParser extends CustomPathExpressionParser {
    parse(text) {
        const parts = text.split('.');
        return { type: 'keypath', parts };
    }
}

// Register via consumed registry
customPathExpressionParsers.define('keypath', new KeypathParser());
{% endhighlight %}

{{ comparisonContent("path-parser-example", code=true) }}
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0;">
    <div>
        <div style="font-size: 0.7rem; font-weight: 600; color: #059669; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f0fdf4; border-bottom: 1px solid #e5e7eb;">Plugged</div>
{% highlight "javascript" %}
// Global availability
class Parser extends
  CustomPathExpressionParser {
  // ...
}
{% endhighlight %}
    </div>
    <div style="border-left: 1px solid #e5e7eb;">
        <div style="font-size: 0.7rem; font-weight: 600; color: #475569; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f8fafc; border-bottom: 1px solid #e5e7eb;">Unplugged</div>
{% highlight "javascript" %}
consume {
  CustomPathExpressionParser
} of '@web-expressions';

class Parser extends
  CustomPathExpressionParser {
  // ...
}
{% endhighlight %}
    </div>
</div>

{{ endContent() }}
