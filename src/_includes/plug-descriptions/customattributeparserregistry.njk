{% from "mode-selector.njk" import pluggedContent, unpluggedContent, comparisonContent, endContent %}

<h3 id="overview">Overview</h3>
<p>Allows defining parsing logic for attribute values, enabling custom syntax and transformations.</p>

<h3 id="interface">Interface</h3>
{% highlight "typescript" %}
interface CustomAttributeParserRegistry extends CustomRegistry<CustomAttributeParser> {
    readonly localName = 'customAttributeParsers';
    define(
        name: string,
        parser: CustomAttributeParser
    ): void;
}
{% endhighlight %}

<h3 id="usage-example">Usage Example</h3>

{{ pluggedContent("attr-parser-example", code=true) }}
{% highlight "javascript" %}
// Access the global registry
const registry = window.customAttributeParsers;

// Define a parser for binding syntax
customAttributeParsers.define('binding', {
    parse(value) {
        // Parse [prop]="expr" syntax
        const match = value.match(/\[(.+?)\]="(.+?)"/);
        return match ? { prop: match[1], expr: match[2] } : null;
    }
});
{% endhighlight %}

{{ unpluggedContent("attr-parser-example", code=true) }}
{% highlight "javascript" %}
consume { customAttributeParsers } of '@web-behaviors';

// Access the consumed registry
const registry = customAttributeParsers;

// Define a parser for binding syntax
customAttributeParsers.define('binding', {
    parse(value) {
        // Parse [prop]="expr" syntax
        const match = value.match(/\[(.+?)\]="(.+?)"/);
        return match ? { prop: match[1], expr: match[2] } : null;
    }
});
{% endhighlight %}

{{ comparisonContent("attr-parser-example", code=true) }}
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0;">
    <div>
        <div style="font-size: 0.7rem; font-weight: 600; color: #059669; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f0fdf4; border-bottom: 1px solid #e5e7eb;">Plugged</div>
{% highlight "javascript" %}
// Global registry
customAttributeParsers.define(
  'binding', parser
);
{% endhighlight %}
    </div>
    <div style="border-left: 1px solid #e5e7eb;">
        <div style="font-size: 0.7rem; font-weight: 600; color: #475569; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f8fafc; border-bottom: 1px solid #e5e7eb;">Unplugged</div>
{% highlight "javascript" %}
consume {
  customAttributeParsers
} of '@web-behaviors';

customAttributeParsers.define(
  'binding', parser
);
{% endhighlight %}
    </div>
</div>

{{ endContent() }}
