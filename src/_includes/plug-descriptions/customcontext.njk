{% from "mode-selector.njk" import pluggedContent, unpluggedContent, comparisonContent, endContent %}

<h3 id="overview">Overview</h3>
<p>Base class for defining context providers with lifecycle callbacks and consumption tracking.</p>

<h3 id="interface">Interface</h3>
{% highlight "typescript" %}
abstract class CustomContext<ContextValue> {
    // Similar to CustomElement
    connectedCallback?(): void;
    disconnectedCallback?(): void;
    adoptedCallback?(): void;

    // Context Specific
    contextConsumedCallback?(
        callback: (...args: unknown[]) => ContextValue
    ): void;
    static readonly observedContexts?: string[];
}
{% endhighlight %}

<h3 id="usage-example">Usage Example</h3>

{{ pluggedContent("context-class-example", code=true) }}
{% highlight "javascript" %}
// Define a theme context
class ThemeContext extends CustomContext {
    value = 'light';

    toggle() {
        this.value = this.value === 'light' ? 'dark' : 'light';
    }
}

// Register globally
customContextTypes.define('theme', ThemeContext);
{% endhighlight %}

{{ unpluggedContent("context-class-example", code=true) }}
{% highlight "javascript" %}
consume {
  CustomContext,
  customContextTypes
} of '@web-contexts';

// Define a theme context
class ThemeContext extends CustomContext {
    value = 'light';

    toggle() {
        this.value = this.value === 'light' ? 'dark' : 'light';
    }
}

// Register via consumed registry
customContextTypes.define('theme', ThemeContext);
{% endhighlight %}

{{ comparisonContent("context-class-example", code=true) }}
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0;">
    <div>
        <div style="font-size: 0.7rem; font-weight: 600; color: #059669; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f0fdf4; border-bottom: 1px solid #e5e7eb;">Plugged</div>
{% highlight "javascript" %}
// Global availability
class Theme extends CustomContext {
  value = 'light';
}

customContextTypes.define(
  'theme', Theme
);
{% endhighlight %}
    </div>
    <div style="border-left: 1px solid #e5e7eb;">
        <div style="font-size: 0.7rem; font-weight: 600; color: #475569; padding: 0.5rem 1rem; text-transform: uppercase; letter-spacing: 0.05em; background: #f8fafc; border-bottom: 1px solid #e5e7eb;">Unplugged</div>
{% highlight "javascript" %}
consume {
  CustomContext,
  customContextTypes
} of '@web-contexts';

class Theme extends CustomContext {
  value = 'light';
}

customContextTypes.define(
  'theme', Theme
);
{% endhighlight %}
    </div>
</div>

{{ endContent() }}

<p class="text-sm text-gray-600 mt-4">
    See <a href="/projects/webcontexts/">Web Contexts</a> for implementation details.
</p>
